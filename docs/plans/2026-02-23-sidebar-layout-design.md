# サイドバーレイアウト設計書

**作成日:** 2026-02-23
**目的:** 学習パスを常時表示のサイドバーに配置し、ノードクリックで右側に詳細パネルを表示するレイアウトに全体を変更する。

---

## 1. 全体レイアウト

```
┌──────────────────────────────────────────────────────┐
│  Lang Version Vocab                                  │
├───────────────┬──────────────────────────────────────┤
│ [言語選択▼]   │  [検索] [タイプフィルタ▼]             │
│ [👤/🚀]       │  [言語概要] [バージョン履歴]           │
│               │                                      │
│ 📘 動的型付け  │  ← ノード未選択時:                    │
│ ├─ 📗 型変換   │    タブのコンテンツ（現状通り）        │
│ ├─ 📗 typeof  │                                      │
│ │  └─ 📙 let  │  ← ノード選択時:                      │
│ 📘 第一級関数  │    学習パス詳細パネル                  │
│ ├─ 📗 クロージャ│   （meaning, コード例, 関連リンク）   │
│ └─ 📗 高階関数 │                                      │
│               │                                      │
└───────────────┴──────────────────────────────────────┘
```

### レイアウト仕様

- アプリ全体 `max-width`: `1200px`（現状 720px から拡大）
- サイドバー幅: `280px`（固定）
- 右側メイン: `flex: 1`
- 2カラムは `display: flex` で実現
- サイドバー: `overflow-y: auto; height: calc(100vh - ヘッダー高)` で独立スクロール

---

## 2. サイドバー

現在の `LearningPathTab.vue` のツリー部分を `LearningPathSidebar.vue` として抽出。

### 含む要素

1. **言語選択ドロップダウン**（SearchFilter から移動）
2. **初心者/経験者モードトグル**
3. **ロードマップツリー**（RoadmapBranch / RoadmapNode を再利用）

### 状態

- `selectedNodeId`: 選択中のノード ID（null = 未選択）
- 選択中のノードに `active` クラスを付与してハイライト
- 同じノードを再クリックで選択解除（トグル動作）

---

## 3. 右側メインエリア

### ノード未選択時

通常のタブコンテンツを表示:
- SearchFilter（検索 + タイプフィルタのみ。言語選択はサイドバーに移動）
- TabNav（2タブ: 言語概要 / バージョン履歴）
- OverviewTab or TermList

### ノード選択時

`NodeDetailPanel.vue`（新規）を表示。タブコンテンツの代わりに表示。

#### 特性ノード選択時

- 特性名（英語 + 日本語）
- レベルバッジ（📘 基礎）
- meaning（説明文）
- 関連概念の一覧（クリックでその概念の詳細に切替）
- ソースURL

#### 概念ノード選択時

- 概念名（英語 + 日本語）
- レベルバッジ（📗 中級）
- 親特性の表示
- meaning（説明文）
- 関連する用語のリスト（バージョン情報付き、クリックで用語詳細に切替）
- ソースURL

#### 用語ノード選択時

- 用語名（英語 + 日本語）
- レベルバッジ（📙 実践）
- タイプバッジ（syntax / api / concept / deprecation）+ カテゴリ
- meaning（説明文）
- コード例（あれば、シンタックスハイライトなし）
- タグ一覧
- 所属バージョン + リリース日
- ソースURL

#### 閉じる操作

- 詳細パネル右上の × ボタン
- サイドバーで同じノードを再クリック
- → `selectedNode = null` に戻り、通常のタブコンテンツを表示

---

## 4. コンポーネント変更一覧

| コンポーネント | 変更 | 内容 |
|---|---|---|
| `App.vue` | 変更 | 2カラムレイアウト。`selectedNode` 状態追加。max-width 拡大 |
| `LearningPathSidebar.vue` | 新規 | サイドバー本体。言語選択 + モード切替 + ツリー |
| `NodeDetailPanel.vue` | 新規 | ノード詳細パネル。レベルに応じた表示切替 |
| `TabNav.vue` | 変更 | 「学習パス」タブを削除。2タブに戻す |
| `SearchFilter.vue` | 変更 | 言語選択をサイドバーに移動。検索 + タイプフィルタのみ |
| `RoadmapNode.vue` | 変更 | `active` クラスのスタイル追加 |
| `LearningPathTab.vue` | 削除 | サイドバーに置き換え |

---

## 5. 状態フロー

```
サイドバーでノードクリック
  → emit('select-node', node)
  → App.vue: selectedNode = node
  → 右側: NodeDetailPanel 表示

同じノード再クリック or ×ボタン
  → App.vue: selectedNode = null
  → 右側: 通常タブコンテンツに戻る

言語切替（サイドバー内）
  → App.vue: langData 更新、selectedNode = null
  → サイドバー: ツリー再構築
  → 右側: タブコンテンツ更新

NodeDetailPanel 内で関連ノードクリック
  → emit('select-node', relatedNode)
  → サイドバーのハイライト更新 + 詳細パネル切替
```
